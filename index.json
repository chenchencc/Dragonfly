[
{
	"uri": "https://alibaba.github.io/Dragonfly/api_reference/api_supernode/",
	"title": "APIs Provided by Supernode",
	"tags": [],
	"description": "",
	"content": "This topic explains how to use the APIs provided by Supernode. This section describes APIs that is provided by the supernode, aka cluster manager.\nRegistration POST /peer/registry  Parameters\nParameters are encodeds as application/x-www-form-urlencoded.\n cid: string, the client id. ip: ipv4 string, the client ip address. hostName: string, the host name of client node. superNodeIp: ipv4 string, the ip address of super node. port: integer, the port which client opens. callSystem: string, the caller identifier. version: string, client version. dfdaemon: boolean, tells whether it is a call from dfdaemon. path: string, the path which client can serve. rawUrl: string, the resource url provided by command line parameter. taskUrl: string, the resource url. md5: string, the md5 checksum for the resource, optional. identifier: string, identifer for the resource. headers: map, extra http headers sent to the raw url.  Under the scene, the cluster manager creates a new instance of Task, which is built from the information provided by parameters. Specifically, it generates a taskId based on rawUrl, md5 and identifier.\nThen the task would be saved in the memory state. At the same time, it will fetch extra information like the content-length which would generally be set. Also, the pieceSize is computed with the strategy below:\n if the total size is less than 200MB, the piece size would be 4MB by default. otherwise, the minimum of (${totalSize} / 100MB) + 2MB and 15MB.  The next step is, the peer information along with the task will be recorded:\n The peerwill be saved. The taskwill be saved.  The last step is about triggering a progress.\nResponse\nAn example response:\n{ \u0026quot;code\u0026quot;: 200, \u0026quot;data\u0026quot;: { \u0026quot;fileLength\u0026quot;: 687481, \u0026quot;pieceSize\u0026quot;: 4194304, \u0026quot;taskId\u0026quot;: \u0026quot;ba270626349198840d0255de8358b6c93fe6d57d922d036fbf40bcf3499f44a8\u0026quot; } }  Other cases could happen:\n the task id might duplicate with an existing one. 606 the url might be invalid. 607 the access requires authentication. 608 or 609  Get Task GET /peer/task  Parameters\nParameters are encoded as query string.\n superNode: ipv4 string, the ip address of super node. dstCid: string, destination client id. range: string, byte range. status: integer. result: integer. taskId: string, the task id. srcCid: string, the source client id.  The super node will analyze the status and result firstly:\n Running if status == 701. Success if status == 702 and result == 501. Fail if status == 702 and result == 500. Wait if status == 700.  In waiting status, the super node would:\n Save the status to be running.  In running status, the super node would will extract the piece status:\n Success if result == 501. Fail if result == 500. SemiSuc if result == 503.  (side note): result == 502 means invalid code.\nAnd update the progress for this specific task. Then it checks the status itself and also the peer status, after that, the super node will tell the client another task which has enough detail for the next piece, or fails if no one is available.\nResponse\nAn example resonse:\n{ \u0026quot;code\u0026quot;: 602, \u0026quot;msg\u0026quot;: \u0026quot;client sucCount:0,cdn status:Running,cdn sucCount: 0\u0026quot; }  This means the client has to wait, since no peer can serve this piece now. And if there is a peer which can serve this request, there will be a reponse like this:\n{ \u0026quot;code\u0026quot;: 601, \u0026quot;data\u0026quot;: [ { \u0026quot;cid\u0026quot;: \u0026quot;cdnnode:10.148.177.242~ba270626349198840d0255de8358b6c93fe6d57d922d036fbf40bcf3499f44a8\u0026quot;, \u0026quot;downLink\u0026quot;: \u0026quot;20480\u0026quot;, \u0026quot;path\u0026quot;: \u0026quot;/qtdown/ba2/ba270626349198840d0255de8358b6c93fe6d57d922d036fbf40bcf3499f44a8\u0026quot;, \u0026quot;peerIp\u0026quot;: \u0026quot;10.148.177.242\u0026quot;, \u0026quot;peerPort\u0026quot;: 8001, \u0026quot;pieceMd5\u0026quot;: \u0026quot;d78ef0af9e95e880fa583b41cf5ad791:687486\u0026quot;, \u0026quot;pieceNum\u0026quot;: 0, \u0026quot;pieceSize\u0026quot;: 4194304, \u0026quot;range\u0026quot;: \u0026quot;0-4194303\u0026quot; } ] }  Peer Progress GET /peer/piece/suc  Parameters\nParameters are encoded as query string.\n dstCid: string, the destination client id. pieceRange: byte range. taskId: string, the task id. cid: string, the client id.  Response\nAn example response:\n{ \u0026quot;code\u0026quot;: 200, \u0026quot;msg\u0026quot;: \u0026quot;success\u0026quot; } "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/onboarding/",
	"title": "Before Starting",
	"tags": [],
	"description": "",
	"content": " Before getting started, let\u0026rsquo;s take a quick look at how to use this documentation portal of Dragonfly.\nNavigating With a rich set of navigation features, you can always locate your target resource at ease.\nNavigating to the homepage To go to the homepage of the Dragonfly documentation portal, do one of the following:\n In the breadcrumb of any page, click Dragonfly. In the address bar of the browser, type https://alibaba.github.io/Dragonfly/ and press Enter.  Navigating to a topic To navigate to a topic, do one of the following:\n In the left-side navigation pane, click a chapter title to expand this chapter, and then click a child topic. In the left-side navigation pane, click a chapter title, and then on the right-side reading pane, click the child topic link.  Navigating to a specific section of a topic Some topics can be lengthy. To jump to a specific section, do the following:\n Hover-over the mini TOC icon in the breadcrumb.\n In the mini TOC overlay, click a section heading.\n  Navigating to other related resources To navigate to other related resources, such as the Dragonfly roadmap, github repo, contributing guide, and so on, click the link under More in the left-side navigation pane.\nSearching Given that the Dragonfly documentation portal is a static website, you can find target information in a blink of an eye.\nTo perform a search, type your key words in the search box on the top of the left-side navigation pane, and matching results will appear in the overlay.\nIn the search results, click any link to jump to the topic, and your key words will be highlighted in yellow.\nImproving the documentation If you see a typo, or just feel like adding your insights, don\u0026rsquo;t hesitate to click the Edit this page link in the breadcrumb. Then you\u0026rsquo;ll be prompted to sign in your Github account and fork the repository.\nFor instructions on how to contribute to the documentation, see Contributing Guide.\n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/user_guide/install_server/",
	"title": "Installing Server",
	"tags": [],
	"description": "",
	"content": "This guide provides instructions for developers to build and run cluster manager (supernode) from source code. The recommended deployment for the cluster manager is that at least two machines with at least 8-core 16G and best to provide Gigabit Ethernet.\n Step 1: Requirements You can either deploy the cluster manager (supernode) on the Docker container or on the physical machine.\n1. Deployed on the Docker container    Software Required Version     Git 1.9.1 +   Docker 1.12.0 +    2. Deployed on the physical machine    Software Required Version     Git 1.9.1 +   Jdk 1.7 +   Maven 3.0.3 +   Nginx 0.8 +    Step2: Getting the source code  $ git clone https://github.com/alibaba/Dragonfly.git  Step3ï¼šBuild and run 1. Run on Docker  Enter the project directory   $ cd Dragonfly   Build Docker image\n Build image   ./build/build.sh supernode   Show Docker images  docker image ls   Get latest supernode Docker imageId  docker image ls | grep supernode |awk '{print $3}' | head -n1   Start Docker container   $ docker run -d -p 8001:8001 -p 8002:8002 ${superNodeDockerImageId}  2. Run on physical machine  Enter the project directory  cd dragonfly/src/supernode   Build the source code  mvn clean -U install -DskipTests=true   Start supernode server\n just start it with this command   # the default value of 'supernode.baseHome' is '/home/admin/supernode' if you don't set java -Dsupernode.baseHome=/home/admin/supernode -jar target/supernode.jar   Start nginx\n Add nginx config    server { listen 8001; location / { # must be ${supernode.baseHome}/repo root /home/admin/supernode/repo; } } server { listen 8002; location /peer { proxy_pass http://127.0.0.1:8080; } }   Example of nginx config  less src/supernode/src/main/docker/sources/nginx.conf   Start nginx   $ sudo nginx  ## Step4: Verify installation - Check if nginx and tomcat is started and port (8001,8002) is available.\n $ ps aux|grep nginx $ ps aux|grep tomcat $ telnet 127.0.0.1 8001 $ telent 127.0.0.1 8002   Install dragonfly client and use dragonfly client to download resource through dragonfly.   $ dfget --url \u0026quot;http://${resourceUrl}\u0026quot; --output ./resource.png --node \u0026quot;127.0.0.1\u0026quot; "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/overview/what_is_dragonfly/",
	"title": "What Is Dragonfly",
	"tags": [],
	"description": "",
	"content": "Dragonfly is an intelligent P2P based image and file distribution system. It aims to resolve issues related to low-efficiency, low-success rate and waste of network bandwidth in file transferring process. Especially in large-scale file distribution scenarios such as application distribution, cache distribution, log distribution, image distribution, etc.\nAt Alibaba, Dragonfly is invoked 2 billion times and the data distributed is 3.4PB every month. Dragonfly has become one of the most important pieces of infrastructure at Alibaba. The reliability is up to 99.9999%.\nWhile container technologies makes devops life easier most of the time, it sure brings a some challenges: the efficiency of image distribution, especially when you have to replicate image distribution on several hosts. Dragonfly works extremely well with both Docker and PouchContainer for this scenario. It also is compatible with any other container formats.\nIt delivers up to 57 times the throughput of native docker and saves up to 99.5% the out bandwidth of registry.\nDragonfly makes it simple and cost-effective to set up, operate,Â and scale any kind of files/images/data distribution.\nWhy Dragonfly? The project is an open source version of the dragonfly and more internal features will be gradually opened.\n P2P based file distribution: Using P2P technology for file transmission, which can make full use of the bandwidth resources of each peer to improve download efficiency, saves a lot of cross-IDC bandwidth, especially costly cross-board bandwidth Non-invasive support all kinds of container technologies: Dragonfly can seamlessly support various containers for distributing images. Host level speed limit: Many downloading tools(wget/curl) only have rate limit for the current download task,but dragonfly also provides rate limit for the entire host. Passive CDN: The CDN mechanism can avoid repetitive remote downloads. Strong consistencyï¼š Dragonfly can guarantee that all downloaded files must be consistent even if users do not provide any check code(MD5). Disk protection and high efficient IO: Precheck Disk space, delay synchronization, write file-block in the best order, split net-read / disk-write, and so on. High performance: Cluster Manager is completely closed-loop, which means, it does not rely on any DB or distributed cache, processing requests with extremely high performance. Exception auto isolation: Dragonfly will automatically isolate exception nodes(peer or Cluster Manager) to improve download stability. No pressure on file source: Generally, as long as a few Cluster Managers download file from the source. Support standard http header: Support http header, Submit authentication information through http header. Effective concurrency control of Registry Auth: Reduce the pressure of the Registry Auth Service. Simple and easy to use: Very few configurations are needed.  How does it stack up against traditional solution?    Test Environment      Dragonfly server 2 * (24core 64GB 2000Mb/s)   File Source server 2 * (24core 64GB 2000Mb/s)   Client 4core 8GB 200Mb/s   Target file size 200MB   Executed Date 2016-04-20    For Dragonfly, no matter how many clients issue the file downloading, the average downloading time is always around 12 seconds. And for wget, the downloading time keeps increasing when you have more clients, and as the amount of wget clients reaches 1200, the file source will crash, then it can not serve any client.\nHow does it work? Distributing General Files The cluster manager is also called supernode, which is responsible for CDN and scheduling every peer to transfer blocks between them. dfget is the client of P2P, also called \u0026lsquo;peer\u0026rsquo;,which is mainly used to download and share blocks.\nDistributing Container Images Registry is similar to the file server above. dfget proxy is also called dfdaemon, which intercepts http-requests from docker pull or docker push,and then determines which requests need use dfget to handle.\nHow file blocks are downloaded Every File is divided into multiple blocks, which are transmitted between peers,one peer is one P2P client. Cluster manager will judge whether the corresponding file exists in the local disk, if not, it will be downloaded into cluster manager from file server.\n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/cli_reference/dfdaemon/",
	"title": "dfdaemon",
	"tags": [],
	"description": "",
	"content": "This topic explains how to use the dfdaemon command. NAME dfdaemon - a proxy between pouchd/dockerd and registry used for pulling images.\n##SYNOPSIS\ndfdaemon [options]\u0026hellip;\nOPTIONS -callsystem string caller name (default \u0026quot;com_ops_dragonfly\u0026quot;) -certpem string cert.pem file path -dfpath string dfget path (default is your installed path) -h\thelp -hostIp string dfdaemon host ip, default: 127.0.0.1 (default \u0026quot;127.0.0.1\u0026quot;) -keypem string key.pem file path -localrepo string temp output dir of dfdaemon (default is \u0026quot;${HOME}/.small-dragonfly/dfdaemon/data\u0026quot;) -maxprocs int the maximum number of CPUs that the dfdaemon can use (default 4) -notbs not try back source to download if throw exception (default true) -port uint dfdaemon will listen the port (default 65001) -ratelimit string net speed limit,format:xxxM/K -registry string registry addr(https://abc.xx.x or http://abc.xx.x) and must exist if dfdaemon is used to mirror mode -rule string download the url by P2P if url matches the specified pattern,format:reg1,reg2,reg3 -urlfilter string filter specified url fields (default \u0026quot;Signature\u0026amp;Expires\u0026amp;OSSAccessKeyId\u0026quot;) -v\tversion -verbose verbose  FILES Local Repository Directory The default local repository is: ${HOME}/.small-dragonfly/dfdaemon/data/, you can change it by setting the option: -localrep.\n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/user_guide/install_client/",
	"title": "Install Client",
	"tags": [],
	"description": "",
	"content": "This topic explains how to install the client.  Install From Latest Package\n Download df-client.linux-amd64.tar.gz tar xzvf df-client.linux-amd64.tar.gz -C xxx, \u0026ldquo;xxx\u0026rdquo; is installation directory. Set environment variable named PATH: export PATH=$PATH:xxx/df-client  Install From Source Code\n  Requirements: go1.7+ and the go cmd must be in environment variable named PATH.\n git clone https://github.com/alibaba/Dragonfly.git, clone source code from GitHub. install in $HOME/.dragonfly\ncd Dragonfly # install `dfdaemon` and `dfget` in $HOME/.dragonfly/df-client ./build/build.sh client # set PATH export PATH=$HOME/.dragonfly/df-client:$PATH  install in other directory\ncd Dragonfly/build/client ./configure --prefix=${your_install_directory} make \u0026amp;\u0026amp; make install export PATH=${your_install_directory}/df-client:$PATH  "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/api_reference/api_preheat/",
	"title": "Preheat API",
	"tags": [],
	"description": "",
	"content": "This topic explains how to use the Preheat API. GET /api/check  check whether the connection to Dragonfly is available\n  Parameters Response: Content-type: application/json HTTP CodeResponse Body   200   { \u0026ldquo;code\u0026rdquo;: 200 }      POST /api/preheat  request to Dragonfly to start a preheat task\n  Parameters: Content-type: application/json Parameter TypeData Type  body  { \u0026ldquo;type\u0026rdquo;: \u0026ldquo;image|file\u0026rdquo;, \u0026ldquo;url\u0026rdquo;: \u0026ldquo;\u0026lt;string\u0026gt;\u0026rdquo;, \u0026ldquo;header\u0026rdquo;: { \u0026ldquo;\u0026lt;name\u0026gt;\u0026ldquo;: \u0026ldquo;\u0026lt;value\u0026gt;\u0026ldquo; } } Dragonfly sends a request taking the \u0026lsquo;header\u0026rsquo; to the \u0026lsquo;url\u0026rsquo;.   If there is any authentication step of the remote server, the header should contain authenticated information.\nIf the type is image, then the url should be image url: \u0026lt;registry_host\u0026gt;/\u0026lt;image_name\u0026gt;:\u0026lt;image_tag\u0026gt;. Dragonfly will preheat the image according to registry API spec, the steps are: * construct manifest_url:  https://\u0026lt;harbor_host\u0026gt;/v2/\u0026lt;image_name\u0026gt;/manifests/\u0026lt;image_tag\u0026gt;  * pull the manifest of the image from manifest_url * get thefsLayers from manifest and construct layer_url of each layer:  https://\u0026lt;harbor_host\u0026gt;/v2/\u0026lt;name\u0026gt;/blobs/\u0026lt;digest\u0026gt;  * request these layer_urls above to handle any redirection response to get real downloading urls * supernodes use these real downloading urls to preheat layers of this image\n Response: Content-type: application/json HTTP CodeResponse Body  200 Success response: { \u0026ldquo;code\u0026rdquo;: 200, \u0026ldquo;data\u0026rdquo;: { \u0026ldquo;taskId\u0026rdquo;: \u0026ldquo;\u0026lt;string\u0026gt;\u0026ldquo; } } Use \u0026lsquo;taskId\u0026rsquo; to query the status of the preheat task. 200 Error Response: { \u0026ldquo;code\u0026rdquo;: 400, \u0026ldquo;msg\u0026rdquo;: \u0026ldquo;\u0026lt;detailed error message\u0026gt;\u0026ldquo; }    GET /api/preheat/{taskId}  query the current status of the preheat task which id is taskId\n  Response: Content-type: application/json HTTP CodeResponse Body  200 Success response: { \u0026ldquo;code\u0026rdquo;: 200, \u0026ldquo;data\u0026rdquo;: { \u0026ldquo;taskId\u0026rdquo;: \u0026ldquo;\u0026lt;string\u0026gt;\u0026rdquo;, \u0026ldquo;status\u0026rdquo;: \u0026ldquo;RUNNING|SUCCESS|FAIL\u0026rdquo; } }  200 Error Response: { \u0026ldquo;code\u0026rdquo;: 400, \u0026ldquo;msg\u0026rdquo;: \u0026ldquo;\u0026lt;detailed error message\u0026gt;\u0026ldquo; }   "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/overview/terminology/",
	"title": "Terminology",
	"tags": [],
	"description": "",
	"content": " This topic lists the common terms used throughout Dragonfly.\nSuperNode SuperNode is a long-time process with two primary responsibilities: * It\u0026rsquo;s the tracker and scheduler in the P2P network that choose appropriate downloading net-path for each peer. * It\u0026rsquo;s also a CDN server that caches downloaded data from source to avoid downloading same files repeatedly.\ndfget Dfget is the client of Dragonfly used for downloading files. It\u0026rsquo;s similar to using wget.\nAt the same time, it also plays the role of peer, which can transfer data between each other in p2p network.\ndfdaemon Dfdaemon is only used for pulling images. It establishes a proxy between dockerd/pouchd and registry.\nDfdaemon filters out layer fetching requests from all requests send by dockerd/pouchd when pulling images, then it uses dfget to downloading these layers.\n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/cli_reference/dfget/",
	"title": "dfget",
	"tags": [],
	"description": "",
	"content": "This topic explains how to use the dfget command. NAME dfget - the client of Dragonfly, a non-interactive P2P downloader\nSYNOPSIS dfget -u [URL] [options]\u0026hellip;\nOPTIONS  -h, --help show this help message and exit --url URL, -u URL will download a file from this url --output OUTPUT, -O OUTPUT, -o OUTPUT output path that not only contains the dir part but also name part --md5 MD5, -m MD5 expected file md5 --callsystem CALLSYSTEM system name that executes dfget,its format is company_department_appName --notbs not back source when p2p fail --locallimit LOCALLIMIT, -s LOCALLIMIT rate limit about a single download task,its format is 20M/m/K/k --totallimit TOTALLIMIT rate limit about the whole host,its format is 20M/m/K/k --identifier IDENTIFIER, -i IDENTIFIER identify download task,it is available merely when md5 param not exist --timeout TIMEOUT, --exceed TIMEOUT, -e TIMEOUT download timeout(second) --filter FILTER, -f FILTER filter some query params of url ,e.g. -f 'key\u0026amp;sign' will filter key and sign query param.in this way,different urls correspond one same download task that can use p2p mode --showbar, -b show progress bar --pattern {p2p,cdn}, -p {p2p,cdn} download pattern,cdn pattern not support totallimit --version, -v version --node NODE, -n NODE specify nodes --console show log on console --header HEADER http header, e.g. --header=\u0026quot;Accept: *\u0026quot; --header=\u0026quot;Host: abc\u0026quot; --dfdaemon caller is from df-daemon  FILES /etc/dragonfly.conf default configuration file for dfget, it configures the address of the supernode.\n[node] address=127.0.0.1,127.0.0.2  ${HOME}/.small-dragonfly This directory is created by dfget when you first time start it.\n.small-dragonfly/ â”œâ”€â”€ data/ # stores temporary data downloaded by dfget â”œâ”€â”€ dfdaemon/ â”‚Â â””â”€â”€ data/ # default, stores temporary data generated by dfdaemon â”œâ”€â”€ logs/ â”‚Â â”œâ”€â”€ dfclient.log # dfget's log file â”‚Â â”œâ”€â”€ dfserver.log # log file of peer server launched by dfget â”‚Â â””â”€â”€ dfdaemon.log # dfdaemon's log file â””â”€â”€ meta/ â””â”€â”€ host.meta # stores meta information: peer server port "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/user_guide/download_files/",
	"title": "Distribuiting Files",
	"tags": [],
	"description": "",
	"content": "This topic explains how to distribute files with Dragonfly. Requirements 1.on linux host\n2.need python 2.7 and make sure it\u0026rsquo;s in the environment variable named PATH.\nStep By Step Configuration 1.specify cluster manager nodes by configuration file or by cmd param\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;cluster manager nodes is deployed above\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;nodeIp is cluster manager ip\n by configuration file for distributing container images or general files   A. vi /etc/dragonfly.conf.\nB. add or update cluster manager nodes as follows:\n[node] address=nodeIp1,nodeIp2,...    by cmd param only for distributing general files  cmd param will cover items in configuration file\n you must apply this param named \u0026ndash;node every time the dfget is executed, for example dfget -u \u0026quot;http://xxx.xx.x\u0026quot; --node nodeIp1,nodeIp2,...\n 2.configure container daemon\nplease ignore this step if you only distribute general files with dragonfly\n start dfget proxy   A. you can execute dfdaemon -h to show help info\nB. the simplest way: dfdaemon --registry https://xxx.xx.x or dfdaemon --registry http://xxx.xx.x , \u0026ldquo;xxx.xx.x\u0026rdquo; is the domain of registry\nC. dfdaemon\u0026rsquo;s log info in ~/.small-dragonfly/logs/dfdaemon.log\n  configure daemon mirror  standard method of configuring daemon mirror for docker\n A. vi /etc/docker/daemon.json, please refer to official document\nB. add or update the item: \u0026quot;registry-mirrors\u0026quot;: [\u0026quot;http://127.0.0.1:65001\u0026quot;],65001 is default port of dfget-proxy\nC. restart docker systemctl restart docker\n Run  distributing general files   you can execute dfget -h to show help info.\nthe simplest way: dfget --url \u0026quot;http://xxx.xx.x\u0026quot;\ndfget\u0026rsquo; log info in ~/.small-dragonfly/logs/dfclient.log\n  distributing docker images   execute docker pull xxx/xx as usual to download images. Note: \u0026ldquo;xxx/xx\u0026rdquo; is the path of image addr and can not contain registry domain that was configured in dfdaemon dfdaemon --registry xxxxxx\n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/overview/",
	"title": "Overview",
	"tags": [],
	"description": "",
	"content": "Get to know Dragonfly and the common terminologies.\n What Is Dragonfly  Dragonfly is an intelligent P2P based image and file distribution system. It aims to resolve issues related to low-efficiency, low-success rate and waste of network bandwidth in file transferring process.  Terminology  This topic lists the common terms used throughout Dragonfly. SuperNode SuperNode is a long-time process with two primary responsibilities: * It\u0026rsquo;s the tracker and scheduler in the P2P network that choose appropriate downloading net-path for each peer. * It\u0026rsquo;s also a CDN server that caches downloaded data from source to avoid downloading same files repeatedly. dfget Dfget is the client of Dragonfly used for downloading files. It\u0026rsquo;s similar to using wget.\n "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/user_guide/supernode_configuration/",
	"title": "SuperNode Configuration",
	"tags": [],
	"description": "",
	"content": "This topic explains the configuration of SuperNode. Properties    Property Name Default Value Description     supernode.baseHome /home/admin/supernode working directory of supernode,   supernode.systemNeedRate 20 the network rate reserved for system, unit is: MB/s   supernode.totalLimit 200 the network rate that supernode can use, unit is: MB/s   supernode.schedulerCorePoolSize 10 the core pool size of ScheduledExecutorService    Usage Currently, the SuperNode is written by Java based on spring-boot. It can easily set properties through the following methods:\n Commandline parameter:\njava -D\u0026lt;propertyName\u0026gt;=\u0026lt;propertyValue\u0026gt; -jar supernode.jar  Configuration file:\njava -Dspring.config.location=./config.properties,\u0026lt;otherConfigFilePath\u0026gt; -jar supernode.jar  "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/quick_start/",
	"title": "Quick Start",
	"tags": [],
	"description": "",
	"content": "The latest release version is 0.2.0, you can quickly experience Dragonfly in the following simple steps. Start SuperNode on Docker Container We provide 2 images in different places to speed up your pulling, you can choose one of them according to your location. * China: registry.cn-hangzhou.aliyuncs.com/alidragonfly/supernode:0.2.0 * USA: registry.us-west-1.aliyuncs.com/alidragonfly/supernode:0.2.0\nHere is the commands if you choose the registry registry.cn-hangzhou.aliyuncs.com/alidragonfly/supernode:0.2.0:\nimageName=\u0026quot;registry.cn-hangzhou.aliyuncs.com/alidragonfly/supernode:0.2.0\u0026quot; docker pull ${imageName} docker run -d -p 8001:8001 -p 8002:8002 ${imageName}  Install Dragonfly Client Download the proper package for your operating system and architecture: * df-client: macOS 64-bit * df-client: linux 64-bit\nUncompress the package and add the directory df-client to your PATH environment variable to make you can directly use dfget and dfdaemon.\nUse Dragonfly to Download a File It\u0026rsquo;s very simple to use Dragonfly to download a file, just like this:\ndfget -u 'https://github.com/alibaba/Dragonfly/blob/master/docs/images/logo.png' -o /tmp/logo.png  Use Dragonfly to Pull an Image We have 2 steps to do before we pull an image:\n start df-daemon with a specified registry:\ndf-daemon --registry https://index.docker.io  configure dockerd and restart:\n\u0026quot;registry-mirrors\u0026quot;: [\u0026quot;http://127.0.0.1:65001\u0026quot;]   NOTE: make sure the SuperNode is running\n  That\u0026rsquo;s all we need to do, then we can pull an image by Dragonfly just as usual:\ndocker pull nginx:latest "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/user_guide/",
	"title": "User Guide",
	"tags": [],
	"description": "",
	"content": "Understand how to use Dragonfly from installing the server and client to distributing files.\n Installing Server  This guide provides instructions for developers to build and run cluster manager (supernode) from source code.  Install Client  This topic explains how to install the client.  Distribuiting Files  This topic explains how to distribute files with Dragonfly.  SuperNode Configuration  This topic explains the configuration of SuperNode.  "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/cli_reference/",
	"title": "CLI Reference",
	"tags": [],
	"description": "",
	"content": "Understand the details of CLI commands.\n dfdaemon  This topic explains how to use the dfdaemon command.  dfget  This topic explains how to use the dfget command.  "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/api_reference/",
	"title": "API Reference",
	"tags": [],
	"description": "",
	"content": "Know the details of our APIs.\n APIs Provided by Supernode  This topic explains how to use the APIs provided by Supernode.  Preheat API  This topic explains how to use the Preheat API.  "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/faq/",
	"title": "FAQ",
	"tags": [],
	"description": "",
	"content": " How can I pull images by Dragonfly See Use Dragonfly to Pull an Image\nHow can I download files by Dragonfly See Use Dragonfly to Download a File\nWhat is SuperNode SuperNode is a long-time process with two primary responsibilities: * It\u0026rsquo;s the tracker and scheduler in the P2P network that choose appropriate downloading net-path for each peer. * It\u0026rsquo;s also a CDN server that caches downloaded data from source to avoid downloading same files repeatedly.\nWhat is dfget Dfget is the client of Dragonfly used for downloading files. It\u0026rsquo;s similar to using wget.\nAt the same time, it also plays the role of peer, which can transfer data between each other in p2p network.\nWhat is dfdaemon Dfdaemon is only used for pulling images. It establishes a proxy between dockerd/pouchd and registry.\nDfdaemon filters out layer fetching requests from all requests send by dockerd/pouchd when pulling images, then it uses dfget to downloading these layers.\n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://alibaba.github.io/Dragonfly/contributing/",
	"title": "Contributing Guide",
	"tags": [],
	"description": "",
	"content": " It is warmly welcomed if you have interest to hack on Dragonfly. First, we encourage this kind of willing very much. And here is a list of contributing guide for you.\nTopics  Reporting security issues Reporting general issues Code and doc contribution Engage to help anything  Reporting security issues Security issues are always treated seriously. As our usual principle, we discourage anyone to spread security issues. If you find a security issue of Dragonfly, please do not discuss it in public and even do not open a public issue. Instead we encourage you to send us a private email to dragonfly-dev@service.alibaba.com to report this.\nReporting general issues To be honest, we regard every user of Dragonfly as a very kind contributor. After experiencing Dragonfly, you may have some feedback for the project. Then feel free to open an issue via NEW ISSUE.\nSince we collaborate project Dragonfly in a distributed way, we appreciate WELL-WRITTEN, DETAILED, EXPLICIT issue reports. To make the communication more efficient, we wish everyone could search if your issue is an existing one in the searching list. If you find it existing, please add your details in comments under the existing issue instead of opening a brand new one.\nTo make the issue details as standard as possible, we setup an ISSUE TEMPLATE for issue reporters. Please BE SURE to follow the instructions to fill fields in template.\nThere are lot of cases when you could open an issue:\n bug report feature request performance issues feature proposal feature design help wanted doc incomplete test improvement any questions on project and so on  Also we must remind that when filing a new issue, please remember to remove the sensitive data from your post. Sensitive data could be password, secret key, network locations, private business data and so on.\nCode and doc contribution Every action to make project Dragonfly better is encouraged. On GitHub, every improvement for Dragonfly could be via a PR (short for pull request).\n If you find a typo, try to fix it! If you find a bug, try to fix it! If you find some redundant codes, try to remove them! If you find some test cases missing, try to add them! If you could enhance a feature, please DO NOT hesitate! If you find code implicit, try to add comments to make it clear! If you find code ugly, try to refactor that! If you can help to improve documents, it could not be better! If you find document incorrect, just do it and fix that! \u0026hellip;  Actually it is impossible to list them completely. Just remember one princinple:\n WE ARE LOOKING FORWARD TO ANY PR FROM YOU.\n Since you are ready to improve Dragonfly with a PR, we suggest you could take a look at the PR rules here.\n Workspace Preparation Branch Definition Commit Rules PR Description  Workspace Preparation To put forward a PR, we assume you have registered a GitHub ID. Then you could finish the preparation in the following steps:\n FORK Dragonfly to your repository. To make this work, you just need to click the button Fork in right-left of alibaba/Dragonfly main page. Then you will end up with your repository in https://github.com/\u0026lt;your-username\u0026gt;/Dragonfly, in which your-username is your GitHub username.\n CLONE your own repository to develop locally. Use git clone https://github.com/\u0026lt;your-username\u0026gt;/Dragonfly.git to clone repository to your local machine. Then you can create new branches to finish the change you wish to make.\n Set Remote upstream to be https://github.com/alibaba/Dragonfly.git using the following two commands:\ngit remote add upstream https://github.com/alibaba/Dragonfly.git git remote set-url --push upstream no-pushing   With this remote setting, you can check your git remote configuration like this:\n$ git remote -v origin https://github.com/\u0026lt;your-username\u0026gt;/Dragonfly.git (fetch) origin https://github.com/\u0026lt;your-username\u0026gt;/Dragonfly.git (push) upstream https://github.com/alibaba/Dragonfly.git (fetch) upstream no-pushing (push)  Adding this, we can easily synchronize local branches with upstream branches.\nBranch Definition Right now we assume every contribution via pull request is for branch master in Dragonfly. Before contributing, be aware of branch definition would help a lot.\nAs a contributor, keep in mind again that every contribution via pull request is for branch master. While in project Dragonfly, there are several other branches, we generally call them rc branches, release branches and backport branches.\nBefore officially releasing a version, we will checkout a rc(release candidate) branch. In this branch, we will test more than branch master.\nWhen officially releasing a version, there will be a release branch before tagging. After tagging, we will delete the release branch.\nWhen backporting some fixes to existing released version, we will checkout backport branches. After backporting, the backporting effects will be in PATCH number in MAJOR.MINOR.PATCH of SemVer.\nCommit Rules Actually in Dragonfly, we take two rules serious when committing:\n Commit Message Commit Content  Commit Message Commit message could help reviewers better understand what is the purpose of submitted PR. It could help accelerate the code review procedure as well. We encourage contributors to use EXPLICIT commit message rather than ambiguous message. In general, we advocate the following commit message type:\n docs: xxxx. For example, \u0026ldquo;docs: add docs about storage installation\u0026rdquo;. feature: xxxx.For example, \u0026ldquo;feature: make result show in sorted order\u0026rdquo;. bugfix: xxxx. For example, \u0026ldquo;bugfix: fix panic when input nil parameter\u0026rdquo;. style: xxxx. For example, \u0026ldquo;style: format the code style of Constants.java\u0026rdquo;. refactor: xxxx. For example, \u0026ldquo;refactor: simplify to make codes more readable\u0026rdquo;. test: xxx. For example, \u0026ldquo;test: add unit test case for func InsertIntoArray\u0026rdquo;. chore: xxx. For example, \u0026ldquo;chore: integrate travis-ci\u0026rdquo;. It\u0026rsquo;s the type of mantainance change. other readable and explicit expression ways.  On the other side, we discourage contributors from committing message like the following ways:\n fix bug update add doc  Commit Content Commit content represents all content changes included in one commit. We had better include things in one single commit which could support reviewer\u0026rsquo;s complete review without any other commits\u0026rsquo; help. In another word, contents in one single commit can pass the CI to avoid code mess. In brief, there are two minor rules for us to keep in mind:\n avoid very large change in a commit; complete and reviewable for each commit.  No matter commit message, or commit content, we do take more emphasis on code review.\nPR Description PR is the only way to make change to Dragonfly project files. To help reviewers better get your purpose, PR description could not be too detailed. We encourage contributors to follow the PR template to finish the pull request.\nEngage to help anything We choose GitHub as the primary place for Dragonfly to collaborate. So the latest updates of Dragonfly are always here. Although contributions via PR is an explicit way to help, we still call for any other ways.\n reply to other\u0026rsquo;s issues if you could; help solve other user\u0026rsquo;s problems; help review other\u0026rsquo;s PR design; help review other\u0026rsquo;s codes in PR; discuss about Dragonfly to make things clearer; advocate Dragonfly technology beyond GitHub; write blogs on Dragonfly and so on.  Issue template Use this template to create an issue.\nIssue Description\nDescribe what happened:\nDescribe what you expected to happen:\nHow to reproduce it (as minimally and precisely as possible): 1. 2. 3.\nAnything else we need to know?:\nEnvironment: - Dragonfly version (see file:VERSION): - OS (e.g. from /etc/os-release): - Kernel (e.g. uname -a): - Others:\nPull request template Use this template to create an issue.\n1.Describe what this PR did\n2.Does this pull request fix one issue? 3.Describe how you did it\n4.Describe how to verify it\n5.Special notes for reviews\n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/code_of_conduct/",
	"title": "Contributor Covenant Code of Conduct",
	"tags": [],
	"description": "",
	"content": " Our Pledge In the interest of fostering an open and welcoming environment, we as contributors and maintainers pledge to making participation in our project and our community a harassment-free experience for everyone, regardless of age, body size, disability, ethnicity, gender identity and expression, level of experience, nationality, personal appearance, race, religion, or sexual identity and orientation.\nOur Standards Examples of behavior that contributes to creating a positive environment include:\n Using welcoming and inclusive language Being respectful of differing viewpoints and experiences Gracefully accepting constructive criticism Focusing on what is best for the community Showing empathy towards other community members  Examples of unacceptable behavior by participants include:\n The use of sexualized language or imagery and unwelcome sexual attention or advances Trolling, insulting/derogatory comments, and personal or political attacks Public or private harassment Publishing others\u0026rsquo; private information, such as a physical or electronic address, without explicit permission Other conduct which could reasonably be considered inappropriate in a professional setting  Our Responsibilities Project maintainers are responsible for clarifying the standards of acceptable behavior and are expected to take appropriate and fair corrective action in response to any instances of unacceptable behavior.\nProject maintainers have the right and responsibility to remove, edit, or reject comments, commits, code, wiki edits, issues, and other contributions that are not aligned to this Code of Conduct, or to ban temporarily or permanently any contributor for other behaviors that they deem inappropriate, threatening, offensive, or harmful.\nScope This Code of Conduct applies both within project spaces and in public spaces when an individual is representing the project or its community. Examples of representing a project or community include using an official project e-mail address, posting via an official social media account, or acting as an appointed representative at an online or offline event. Representation of a project may be further defined and clarified by project maintainers.\nEnforcement Instances of abusive, harassing, or otherwise unacceptable behavior may be reported by contacting the project team at shlallen1990@gmail.com. The project team will review and investigate all complaints, and will respond in a way that it deems appropriate to the circumstances. The project team is obligated to maintain confidentiality with regard to the reporter of an incident. Further details of specific enforcement policies may be posted separately.\nProject maintainers who do not follow or enforce the Code of Conduct in good faith may face temporary or permanent repercussions as determined by other members of the project\u0026rsquo;s leadership.\nAttribution This Code of Conduct is adapted from the Contributor Covenant, version 1.4, available at http://contributor-covenant.org/version/1/4\n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/",
	"title": "Dragonfly",
	"tags": [],
	"description": "",
	"content": "        \nWhat is Dragonfly? Dragonfly is an intelligent P2P based image and file distribution system. It aims to resolve issues related to low-efficiency, low-success rate and waste of network bandwidth in file transferring process. Especially in large-scale file distribution scenarios such as application distribution, cache distribution, log distribution, image distribution, etc. In Alibaba, Dragonfly is invoiked 2 Billion times and the data distributed is 3.4PB every month. Dragonfly has become one of the most important pieces of infrastructure at Alibaba. The reliability is up to 99.9999%.\nWhile container technologies makes devops life easier most of the time, it sure brings a some challenges: the efficiency of image distribution, especially when you have to replicate image distribution on several hosts. Dragonfly works extremely well with both Docker and PouchContainer for this scenario. It also is compatible with any other container formats.\nIt delivers up to 57 times the throughput of native docker and saves up to 99.5% the out bandwidth of registry.\nDragonfly makes it simple and cost-effective to set up, operate,Â and scale any kind of files/images/data distribution.\nWhy Dragonfly? The project is an open source version of the dragonfly and more internal features will be gradually opened.\n P2P based file distribution: Using P2P technology for file transmission, which can make full use of the bandwidth resources of each peer to improve download efficiency, saves a lot of cross-IDC bandwidth, especially costly cross-board bandwidth Non-invasive support all kinds of container technologies: Dragonfly can seamlessly support various containers for distributing images. Host level speed limit: Many downloading tools(wget/curl) only have rate limit for the current download task,but dragonfly also provides rate limit for the entire host. Passive CDN: The CDN mechanism can avoid repetitive remote downloads. Strong consistencyï¼š Dragonfly can guarantee that all downloaded files must be consistent even if users do not provide any check code(MD5). Disk protection and high efficient IO: Precheck Disk space, delay synchronization, write file-block in the best order, split net-read / disk-write, and so on. High performance: Cluster Manager is completely closed-loop, which means, it does not rely on any DB or distributed cache, processing requests with extremely high performance. Exception auto isolation: Dragonfly will automatically isolate exception nodes(peer or Cluster Manager) to improve download stability. No pressure on file source: Generally, as long as a few Cluster Managers download file from the source. Support standard http header: Support http header, Submit authentication information through http header. Effective concurrency control of Registry Auth: Reduce the pressure of the Registry Auth Service. Simple and easy to use: Very few configurations are needed.  How does it stack up against traditional solution?    Test Environment      Dragonfly server 2 * (24core 64GB 2000Mb/s)   File Source server 2 * (24core 64GB 2000Mb/s)   Client 4core 8GB 200Mb/s   Target file size 200MB   Executed Date 2016-04-20    For Dragonfly, no matter how many clients issue the file downloading, the average downloading time is always around 12 seconds. And for wget, the downloading time keeps increasing when you have more clients, and as the amount of wget clients reaches 1200, the file source will crash, then it can not serve any client.\nWho has adopted Dragonfly? Below are the adoptors of project Dragonfly. If you are using to Dragonfly to improve your distribution, please contact us with.\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\nLicense Dragonfly is available under the Apache 2.0 License.\nCommercial Support If you need commercial support of Dragonfly, please contact us for more information: äº‘æ•ˆ.\nDragonfly is already integrated with AliCloud Container Services If you need commercial support of AliCloud Container Service, please contact us for more information: Container Service \n"
},
{
	"uri": "https://alibaba.github.io/Dragonfly/maintainers/",
	"title": "Maintainers",
	"tags": [],
	"description": "",
	"content": "   GitHub ID Name Email Company     allencloud Allen Sun allensun.shl@alibaba-inc.com Alibaba Group   chenchaobing Chaobing Chen chenchaobing@126.com Meitu   garfield009 Zuozheng Hu zuozheng.hzz@alibaba-inc.com Alibaba Group   lowzj Jin Zhang zj3142063@gmail.com Alibaba Group   wangj998 Jian Wang mingzhi.wj@alibaba-inc.com Alibaba Group   zhouhaibing089 Haibing Zhou zhouhaibing089@gmail.com Ebay China    "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/roadmap/",
	"title": "Roadmap",
	"tags": [],
	"description": "",
	"content": " CNCF Ecosystem  Deploy SuperNode using Helm in Kubernetes Deploy dfget \u0026amp; dfdaemon using DaemonSet in Kubernetes Integration with Harbor: preheat image feature  Security  Support private container image Support authentication in SuperNode API Different encryption algorithm in data transmission  Efficiency  Dynamic downloading rate limiting and scheduling algorithm Use IPFS to share block datas between SuperNodes  Openness  Plug-In policy for CNCF projects Highly user-customized modules Refactor SuperNode with Golang  Scalability  Simplify the complexity of scaling SuperNodes in Kubernetes  Stability  Cluster the SuperNode to decrease possibility of failure  "
},
{
	"uri": "https://alibaba.github.io/Dragonfly/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]